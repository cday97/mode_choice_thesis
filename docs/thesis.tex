% This is the Reed College LaTeX thesis template. Most of the work
% for the document class was done by Sam Noble (SN), as well as this
% template. Later comments etc. by Ben Salzberg (BTS). Additional
% restructuring and APA support by Jess Youngberg (JY).
% Your comments and suggestions are more than welcome; please email
% them to cus@reed.edu
%
% See https://www.reed.edu/cis/help/LaTeX/index.html for help. There are a
% great bunch of help pages there, with notes on
% getting started, bibtex, etc. Go there and read it if you're not
% already familiar with LaTeX.
%
% Any line that starts with a percent symbol is a comment.
% They won't show up in the document, and are useful for notes
% to yourself and explaining commands.
% Commenting also removes a line from the document;
% very handy for troubleshooting problems. -BTS

% As far as I know, this follows the requirements laid out in
% the 2002-2003 Senior Handbook. Ask a librarian to check the
% document before binding. -SN

%%
%% Preamble
%%
% \documentclass{<something>} must begin each LaTeX document
\documentclass[12pt, oneside, openright]{byuthesis}


\title{Determining the significance of a consistent mode choice between activity-based models and agent-based microsimulation tools}
\author{Christopher Day}
\copyyear{2022}
\committeeMembers{Brigham Young, Chair

Karl G. Maeser

Harvey Fletcher}
\keywords{Four Step Model, Discrete Choice Model, Activity-based Model}
\degree{Master of Science}
\doctype{thesis}
\department{Department of Civil and Construction Engineering}



	\usepackage{algorithm}
	\usepackage{algpseudocode}
	\usepackage{dsfont}
% End of CII addition
%%
%% End Preamble
%%
%

% Pandoc citation processing
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslentryspacingunit} % times entry-spacing
\setlength{\cslentryspacingunit}{\parskip}
% for Pandoc 2.8 to 2.10.1
\newenvironment{cslreferences}%
  {}%
  {\par}
% For Pandoc 2.11+
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
  \let\oldpar\par
  \def\par{\hangindent=\cslhangindent\oldpar}
  \fi
  % set entry spacing
  \setlength{\parskip}{#2\cslentryspacingunit}
 }%
 {}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}\break}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}

\begin{document}

\begin{abstract}
This document describes the use of a new \LaTeX ~template for writing masters
theses at Brigham Young University. This was made necessary by the relative age
and complication of prior templates. Additionally, the new \texttt{cosmodown} R package
contains an implementation of this thesis in R markdown, with the help of the
\href{https://github.com/ismayc/thesisdown}{\texttt{thesisdown}} package.

The abstract of a thesis should describe the
motivation, objective, overall results, and central findings of the thesis.
It may have multiple paragraphs if necessary.
\end{abstract}


\makefrontmatter % this stuff will be roman-numbered
\thesisbody

\hypertarget{outline}{%
\chapter{Outline}\label{outline}}

Here is my outline for the entire thesis. Hopefully this will give me a rough idea of what to write about.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Introduction \emph{(5pg)}
\end{enumerate}

\begin{verbatim}
a. First/Last mile transit
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Literature Review \emph{(20-30pg)}
\end{enumerate}

\begin{verbatim}
a. Discus Mode Choice (4-step model, ABMs, microsimulations)
b. Discuss ActivitySim (modechoice)
c. Discuss MATSim (modechoice)
d. Discuss BEAM (modechoice)
e. Figure explaining tour type and first trip difference?
f. Variables showing path,person,location?
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Methods
\end{enumerate}

\begin{verbatim}
a. What did we add to BEAM?
b. Algorithms
c. How did we make scenario?
d. What scenarios did we run? SLC + SL / Data & Calibration
e. What tests did we run? (path, person, location effects)
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Results
\end{enumerate}

\begin{verbatim}
a. Describe tests and findings
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Discussion
\end{enumerate}

\begin{verbatim}
a. What does it mean?
b. Limitations --> Future research recommendation
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{5}
\tightlist
\item
  Conclusions
\end{enumerate}

\begin{verbatim}
a. Wider implications
b. First mile last mile
c. climate change lol
\end{verbatim}

\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

In the intro talk about the tscore setup, along with the desire to understand on-demand transit vehicles. Talk about how a consistent mc will help better model these on demand transit vehicles.

\hypertarget{problem-statement}{%
\section{Problem Statement}\label{problem-statement}}

\hypertarget{purpose-of-research}{%
\section{Purpose of Research}\label{purpose-of-research}}

\hypertarget{outline-of-research}{%
\section{Outline of Research}\label{outline-of-research}}

\hypertarget{literature-review}{%
\chapter{Literature Review}\label{literature-review}}

\hypertarget{overview}{%
\section{Overview}\label{overview}}

Mode choice models are essential components in the transportation planning process. Key investment decisions along with other transportation decisions rely on the determination of individual mode choices within a population. Whether mode choice is estimated in a four step model, activity-based model, or an agent based model, its level of significance remains the same.

\hypertarget{lit1}{%
\section{Mode Choice in the Four Step Model}\label{lit1}}

The four step model (FSM) has been the primary tool in person travel demand modeling since its development (McNally 2000). Although travel is theorized to be derived from activity participation, the FSM focuses on modeling with trip-based not activity-based travel methods. The methodology presented in the FSM is mostly universal. The FSM can be divided up into two stages. The first defining the traveler and land use characteristics and the second where demand is loaded onto a transportation network and travel characteristics are determined (McNally 2000).

As its name suggests, the FSM includes four different steps: trip generation, trip distribution, mode choice, and route choice. In trip generation the magnitude of total trips is estimated and in trip distribution those trips are disbursed along different directions of travel. In mode and route choice, a multitude of variables are used to determine specifically how travel occurs.

Of the four steps in the FSM, mode choice in particular is a diverse, variable, and disaggregate step among different modeling applications. According to McNally (2000), mode choice is almost exclusively modeled on a disaggregate level within separate choice-based sampling. Choice probabilities are calculated on the individual trip level. McNally (2000) also mentions that with transit, carpooling vehicles, automobile tolls, and other new factors the mode choice algorithm can become extensive and difficult to determine. One common method used to estimate mode choice probabilities is a nested logit model (see Section \ref{lit3}). These mode choice models can reflect trip-maker characteristics as well as multiple performance variables (Ortuzar and G.Willumsen 1994; McNally 2000). Most applications of the FSM require multiple iterations of the mode choice and trip distribution steps in order to approximate formal convergence. Like with the nested logit model, discrete choice modeling has historically been the perferred method in estimating mode choice in the FSM as well as in other modeling applications.

\hypertarget{lit2}{%
\section{A Brief History of Mode Choice in Discrete Choice Models}\label{lit2}}

Various choice modeling systems have been used to accurately determine mode choices. The beginning of such analyses started with the developments of McFadden et al. (1973), who outlined a general procedure for modeling population choice behavior from distributions of individual decision rules. Before then, discrete choices were simply modeled using a random utility model (RUM) framework. The interpretation assumed that each individual carried their own utility function distribution and selected one randomly; according to Manski (2001), McFadden reinterpreted the random assignment of the utility functions across the population itself rather than the individual. This yielded an entirely new view of discrete choice modeling, and a more general version of the multinomial logit model (MNL) was introduced. This new MNL model, also called the conditional logit analysis, was the beginning of modern mode choice analysis. Goulias, Davis, and Bhat (2020) describe that McFadden's MNL model, the nested logit model, and the multinomial probit model (MNP) were the main engines in mode choice and most discrete choice analyses up through the 1990s.

Although the developments of McFadden are still in effect today, mode choice analysis has evolved greatly in the last few decades. Goulias, Davis, and Bhat (2020) explain that up through 2010, mixed multinomial logit (MMNL) models and multiple discrete-continuous (MDC) choice models were the main models in practice. In addition, Bhat (1995) estimated a disaggregate mode choice model to explain how new and updated services affected ridership and mode choice on intercity travel. His heteroscedastic extreme value model overcame the independence of irrelevant alternatives (IIA) property and allowed more flexibility among the alternatives than the nested logit model. Ben-Akiva, Mcfadden, et al. (2002) developed a hybrid choice model (HCM) that went beyond the standard RUM as it included latent variables, latent classes, and a flexible error structure. It implemented multiple facets of discrete choice modeling and more accurately represented the behaviors of the individuals. Pinjari et al. (2007) used a simultaneous mixed logit model to understand how commuters' mode choice is affected by the surrounding build environment.

According to Goulias, Davis, and Bhat (2020), from 2010 to 2015 joint models of data with mixed dependent variables arrived. Vij, Carrel, and Walker (2013), for example, used a behavioral mixtures model, composed of a latent class choice model (LCCM) and a continuous logit mixture model, to extrapolate unobserved modality styles and their effects on travel decisions. Paulssen et al. (2014) focused on improving the integrated choice and latent variable (ICLV) model of McFadden (1986) and Ben-Akiva, Walker, et al. (2002) by including a value system among the individuals. Overall, the general advancement within mode choice and discrete choice modeling is comprehensive across recent years. Similarly, the variability among mode choice analysis can specifically be seen within activity-based modeling.

\hypertarget{lit3}{%
\section{An Extensive Look into Mode Choice in Activity-Based Models}\label{lit3}}

A significant part of activity-based modeling is the mode choice decision within the model. Bhat and Koppelman (1999) stated that originally travel demand models used individual trips as the primary unit of analysis. In recent years though, there has been a shift toward activity-based travel demand modeling. According to Eluru et al. (2010), this shift has occurred due to improved understanding of activity-based travel, global climate concerns, and advances in microsimulation techniques. With this shift to activity-based travel modeling, FSMs have evolved immensely, and especially within the last decade (Hasnine and Nurul Habib 2021). A major maturing in activity scheduling, activity duration, activity generation, and location choice has occurred and resulted in advanced activity-based modeling. Although these components have evolved significantly, the mode choice decision has remained relatively simple and constant.

In general, the two types of mode choice models commonly applied in travel demand modeling are trip-based and tour-based models. Trip-based mode choice models select modes based on the characteristics of individual trips, independent of other existing trips. A tour is defined as a chain of trips that end in the same location as they start (John L. Bowman et al. 1999). Tour-based models are based on the characteristics of the trips' overarching tour, meaning trip modes are not independently calculated. Most activity-based models commonly implement the tour-based mode choice structure (Hasnine and Nurul Habib 2021).

The most common use of the tour-based mode choice model is the ``simplified tour-based'' mode choice model. The simplified tour-based model has been used in a variety of studies (Arentze and Timmermans 2000; J. L. Bowman and Ben-Akiva 2001; Ram M. Pendyala et al. 1997). This simplified model hinges on trip-based mode choice where a single mode is used to define the entire tour opposed to a string of possible mode option combinations. For example, a simplified tour-based mode choice would define the tour-mode as ``public transit'' whereas a true tour-based model would define the tour-mode as ``public transit - ride hail - public transit''. Simplified tour-based models overlooks mobility attributes as well as the dynamics that exist between trips on a tour (Hasnine and Nurul Habib 2021).

There have been many attempts during the last few decades to include trip and tour based mode choice models into activity-based models. As a way to better understand the diversity that exists with tour-based mode choice in activity-based models, Hasnine and Nurul Habib (2021) conducted research on a variety of activity-based models from the years 1995 to 2020 and found that seven specific mode choice analyses have been used. All seven techniques are framed about the tour-based methodology further reinforcing the knowledge that ``the tour-based approach is the most relevant to the activity-based modelling framework'' (Hasnine and Nurul Habib 2021). These seven categories are further discussed in the following subsections.

\hypertarget{lit31}{%
\subsection{Simplified main tour model}\label{lit31}}

The simplified main tour model is another name for the simplified tour-based model previously discussed and implemented in most activity-based modeling applications (Arentze and Timmermans 2000; J. L. Bowman and Ben-Akiva 2001; Ram M. Pendyala et al. 1997). In the A Learning-Based Transportation Oriented Simulation System (ALBATROSS) developed by Arentze and Timmermans (2000), for example, when individuals had a work activity in their daily plan, a transport mode was determined for the work travel purpose. A singular tour mode value was selected and given to that individual. In cases where households had less cars than people, a car tour mode assigned to one individual in a household may prevent a car mode being given to another individual in that same household. In this way, the simplified main tour model keeps track of car ownership and availability in a logical way. The ALBATROSS system selected the tour mode based on a subset of rules and decision trees programmed into the model. This means that the ALBATROSS system only allowed each trip within a tour to have the same mode as the tour mode (Arentze and Timmermans 2000).

Since a singular mode value is assigned to the tour in the simplified main tour model method, no flexibility exists for trip mode selection. Once a tour mode is determined, that same mode is held constant for each trip within that tour. Although not entirely realistic, many modelers prefer this method as it is a computationally easier task than a tour-based mode choice that permits trip modes to be different than their overarching tour mode. Realistically, however, individuals often vary their modes on different trips within a tour. For example, those who walk or bike or drive to transit are unable to do so in a simplified main tour model. Using the simplified main tour mode choice model may be popular and computationally simple, but it is not dynamic or realistic in representing travel behavior (Hasnine and Nurul Habib 2021).

\hypertarget{lit32}{%
\subsection{Two-tier nested logit model}\label{lit32}}

The two-tier nested logit model first completes an upper-level location choice followed by a lower-level mode choice which corresponds to the destination's location. One example of this approach being implemented in the literature is the Florida Activity Mobility Simulator (FAMOS) model (Ram M. Pendyala et al. 2005). The FAMOS model uses both the Household Attributes Generation System and the Prism-Constrained Activity-Travel Simulator in order to model activity patterns. The sub models within FAMOS include an activity-type choice, a joint destination and mode choice, and an activity duration choice. Additionally, FAMOS mode choice model first determines the destination location, and then selects a mode dependent on the destination location. Although it uses a two-tier nested logit model, Hasnine and Nurul Habib (2021) states that a tour-based mode choice is not ``explicitly identified'' in the FAMOS model. At its development, FAMOS gave promising results in the effectiveness of an activity-based modeling system (Ram M. Pendyala et al. 2005). It did not however include an extensive and powerful mode choice model.

\hypertarget{lit33}{%
\subsection{Simplified main tour mode and conditional trip-level mode}\label{lit33}}

The simplified main tour mode and conditional trip-level mode choice model has two parts. First a tour mode is estimated. Then, conditional on the estimated tour mode and attributes of the activity, trip modes are estimated. One example of a model that uses this structure is called DaySim (John L. Bowman, Bradley, and Gibbs 2006). DaySim follows the same activity scheduling approach developed by J. L. Bowman and Ben-Akiva (2001). The DaySim model is a microsimulation model that works off of four levels: long term person/household decisions, single day activity patterns, tour-level decisions, and trip-level decisions. The mode choice structure within DaySim involves a series of logsums and approximated logsums in order to econometrically estimate individual mode choice. More specifically, first a logsum is used to determine an overarching tour mode. This mode is used for all trip modes under that tour for the first steps within the model (John L. Bowman, Bradley, and Gibbs 2006). Later, however, trip modes are updated individually based on the tour mode value, origin and destination locations, and start times. The mode choice approach in DaySim is effective in that it relies heavily on fundamental econometric theories and allows trip modes to vary from tour modes (Hasnine and Nurul Habib 2021).

Other examples in the literature also use the simplified main tour mode and conditional trip-level mode choice structure, however only the details realting to ActivitySim's mode choice structure will be discussed further (see Section \ref{lit4})

\hypertarget{lit34}{%
\subsection{An activity-based model with exogenous mode choice}\label{lit34}}

The idea behind this mode choice model is that the mode choice decision is not estimated within the activity-based model, but estimated outside of it. One example of an activity-based model with the mode choice decision estimated exogenously is the comprehensive utility-based system of activity-travel scheduling options modelling (CUSTOM). The research done by Nurul Habib (2017) using the CUSTOM system assumed an exogenous mode choice. This meant that the mode specific travel time used to estimate travel behavior was an explanatory variable in the model. Nurul Habib (2017) mentions that the exogenous mode choice was a limitation in their research and further research is needed to specifiy how to seemlessly align the exogenous mode choice into the CUSTOM structure. Hasnine and Nurul Habib (2021) also mentions that a limitation to this mode choice model is that the mode is not modeled endogenously with other activity attributes.

\hypertarget{lit35}{%
\subsection{Simulation-based tour-based mode choice}\label{lit35}}

The simulation-based tour-based mode choice model is a simulation-based approach to estimating modes when large sets of modal alternatives are present. An example of this approach in the literature is a model used by Miller, Roorda, and Carrasco (2005) called the Travel/Activity Scheduler for Household Agents (TASHA). TASHA is both agent-based and activity-based where decisions are modeled using a random utility framework. In addition, TASHA is both chain-based and trip-based meaning that individual trips have individual modes chosen, but tour modes are constructed in a chain-based manner. Utility functions are used to calculate the utility of both individual trip modes as well as chains of modes used in the tour-based mode choice model. TASHA adopts a probit modeling structure in order to determine probabilities of modal alternatives (Miller, Roorda, and Carrasco 2005; Hasnine and Nurul Habib 2021). This simulation approach is computationally heaving but is effective in providing unique trip modes based on chain-based tour modes.

Another example of a simulation-based mode choice model is presented by Eluru et al. (2010). Eluru et al. (2010) developed a joint multiple discrete continuous extreme value (MDCEV) framework to model the individual's choices across five dimensions: activity type, time of day, mode, destination, and time use. The MDCEV framework aimed to model activity travel choices simultaneously.

\hypertarget{lit36}{%
\subsection{Combinatorial tour-based mode choice}\label{lit36}}

The combinatorial tour-based mode choice model simulates all combinations of modes within any given tour. A utility value is then calculated for the each combination of trip modes and a logit model is used to determine which combination any given agent will select. This method is computationally heavy, but allows the possibility for any combination of modes to exist (Hasnine and Nurul Habib 2021). An example of this model being used in practice is the research conducted by Vovsha et al. (2017).

\hypertarget{lit37}{%
\subsection{Dynamic tour-based mode choice}\label{lit37}}

Dynamic tour-based mode choice models are programmed with dynamic discrete choice modeling. The central idea is to model sequential discrete choices in order to determine current and future outcomes. Saleem, Västberg, and Karlström (2018) provides an example of implementing a dynamic tour-based mode choice model in the random utility based travel model named SCAPER. SCAPER makes decisions sequentially in time based on a random utility theory. MATSim also implements the SCAPER model by generating activity schedules, activity durations, activity locations, and mode choices. MATSim iteratively updates the mode choice based on the best modal option available, and continues to iteratively update mode choice until schotastic equilibrium is reached (Hasnine and Nurul Habib 2021). More intimate details inside the MATSim mode choice model will be discussed later on (see Section \ref{lit5}).

Overall, the seven categories of mode choice presented by Hasnine and Nurul Habib (2021) gives a good overview on the details behind existing mode choice structures within activity-based models. It is shown that although trip-based models have been used, tour-based mode choice models are the prominent form of mode choice modeling in activity-based models. ActivitySim is the activity-based model used in this research, and so the details of its mode choice structure will be analyzed more closely in Section \ref{lit4}.

\hypertarget{lit4}{%
\section{The Mode Choice Models used in ActivitySim}\label{lit4}}

The activity-based model used in this research to generate activity plans is ActivitySim. ActivitySim is an activity simulator used to generate plans for millions of agents each with their own demographic attributes (Gali et al. 2008). Instead of independently modeling each trip, ActivitySim simulates each individual and their daily travel diaries and schedules. Since ActivitySim forecasts travel based on a disaggregate population, more realistic travel estimates are generated than can be generated by forecasting travel using aggregate trips. Long term decisions are made first, and then shorter term decisions are calculated based on the long term decisions ({``ActivitySim: An Advanced Activity-Based Travel Demand Model Built by and for Users''} 2021). Overall, ActivitySim is an advanced activity-based model that is cost effective, user friendly, and effecient at forecasting travel behavior.

As discussed in Section \ref{lit33}, ActivitySim adopts a simplified main tour mode model and a conditional trip-level mode model for its mode choice framework. The specifics of this dual level mode choice is described further in its application by MTC (2012). The details of this specific mode choice framework is discussed further.

The mode choice model in ActivitySim is multifaceted between tours, trips, and purpose. In other words, there is a mode choice model that determines the \emph{primary} mode for each tour and a separate mode choice model that determines the mode for each trip within each tour (MTC 2012). The tour choice is the upper-level choice whereas the trip mode choice is the lower-level choice that is conditional upon the upper-level choice. Two levels of mode choice is a more advanced than the simplified main tour mode choice model.

This overarching mode choice structure exists separately for each purpose. This means that since there are ten purposes specified in ActivitySim, there are ten tour mode choice models and 10 trip mode choice models, making a total of 20 mode choice models!

Multiple travel statistics are calculated at the trip and the tour level. At the tour level the tour modes, stop frequencies, and stop locations are estimated. Then, at the trip level the departure times, trip modes, parking for automobiles, and vehicle assignments are determined ({``ActivitySim: An Advanced Activity-Based Travel Demand Model Built by and for Users''} 2021).

\hypertarget{lit41}{%
\subsection{ActivitySim's Tour Mode Choice Model}\label{lit41}}

The tour mode choice model assigns the primary mode that is used to get from origin to destination. This level accounts for variables that affect the entire tour. The tour mode decision also affects the alternative values that are available for each trip. The specific details that determine which mode is used for each tour have to do with whether the tour is done by private car or by public transit, walking, or biking; whether there is carpooling available; and whether the transit mode is accessible by foot or by car (MTC 2012).

The specific choice model used to determine the overarching tour's mode is a nested logit model. It separates similar modes into the differing bins as to ``more accurately model the cross-elasticities between the alternatives'' (MTC 2012). Figure \ref{fig:fig1} shows all 18 modes within ActivitySim and how they fit within the nested logit structure.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{pics/tour_nest} 

}

\caption{Tour Mode Choice Nested Logit Model (MTC 2012).}\label{fig:fig1}
\end{figure}

The first decision of modes is whether it is an automobile, a non-motorized vehicle, or a transit type. In a broad sense, the second level of nesting for automobile and non-motorized has to do with vehicle occuppancy. If it is an automobile, three secondary bins exist: drive-alone, shared-ride with two people, and shared-ride with three or more people. Then, in the third level of nesting, two bins exist having to do with if the mode is free or not. On the other hand, the non-motorized section is only divided up into the walk or bike mode on a secondary level, with no options on the third level. The transit nest is divided into walk-transit and drive transit on the secondary level. There are then five more bins within each one of those transit options having to do with which specific transit type is involved, like LRT, express, etc. The logsum coeffiecients for the first nest is 0.72 and for the second nest 0.35 (MTC 2012).

The utility functions for each mode are shown in Section \ref{lit411}. The primary variables in the utility functions are in-vehicle time, other travel times, cost, characteristics of the destination zone, demographics, and auto ownership of the household. Each mode has different parameter values for each one of the variables, for each tour purpose value.

\hypertarget{lit411}{%
\subsection{ActivitySim's Tour Mode Choice Utility Functions}\label{lit411}}

The utility functions for the auto, nonmotorized, and transit modes are presented in this section. All \(\beta\) and \(ASC\) values are meant to represent parameter values. All other variables are dependent on other things, like time for example. (The utility equations are deduced from information from MTC (2012)).

\textbf{Auto}

\(V_{DriveAlone} = IVTT(\beta_{IVTT}) + ASC_{DA1619}\)

\(V_{Shared2} = IVTT(\beta_{IVTT}) + OVTT_w(\beta_{OVTT_w}) + ASC_{DA16P} + ASC_{HHS} + ASC_{ITC} + ASC_{JTC}\)

\(V_{Shared3P} = IVTT(\beta_{IVTT}) + OVTT_w(\beta_{OVTT_w}) + ASC_{DA16P} + ASC_{HHS} + ASC_{ITC} + ASC_{JTC}\)

\begin{itemize}
\tightlist
\item
  \(IVTT\) is the in-vehicle travel time (min),
\item
  \(OVTT_w\) is the initial wait time (min); \(\beta_{OVTT_w}\) is different depending on if \(OVTT_w\) is above or below 10 minutes,
\item
  \(ASC_{DA1619}\) is a demographic variable for individuals between 16-19 years old,
\item
  \(ASC_{DA16P}\) is a demographic variable for individuals 16 years old or older,
\item
  \(ASC_{HH}\) is a demographic variable for household size; different depending on size,
\item
  \(ASC_{ITC}\) is an individual tour constant; different depending on ratio of number of cars to number of workers, and
\item
  \(ASC_{JTC}\) is a joint tour constant; different depending on ratio of number of cars to number of workers
\end{itemize}

\textbf{NonMotorized}

\(V_{Walk} = DIS(\beta_{DIS}) + ZTI(\beta_{ZTI}) + ZDI_d(\beta_{ZDI_d}) + ZDI_o(\beta_{ZDI_o}) + ASC_{ITC} + ASC_{JTC}\)

\(V_{Bike} = DIS(\beta_{DIS}) + ZTI(\beta_{ZTI}) + ZDI_d(\beta_{ZDI_d}) + ZDI_o(\beta_{ZDI_o}) + ASC_{ITC} + ASC_{JTC}\)

\begin{itemize}
\tightlist
\item
  \(DIS\) is the distance travled (miles); \(\beta_{DIS}\) is different depending on if \(DIS\) is above or below 1.5 miles for walk and 6 miles for bike,
\item
  \(ZTI\) is the zonal topography index at the destination,
\item
  \(ZDI_d\) is the zonal density index at the destination,
\item
  \(ZDI_o\) is the zonal density index at the origin,
\item
  \(ASC_{ITC}\) is an individual tour constant; different depending on ratio of number of cars to number of workers, and
\item
  \(ASC_{JTC}\) is a joint tour constant; different depending on ratio of number of cars to number of workers
\end{itemize}

\textbf{Transit}

\(V_{WalkTransit} = IVTT(\beta_{IVTT}) + [OVTT_w(\beta_{OVTT_w}) + OVTT_t(\beta_{OVTT_t}) + ASC_{OVTT_d} + ASC_{OVTT_o}] \\ \qquad + T(\beta_T) + ZTI(\beta_{ZTI}) + ZDI_d(\beta_{ZDI_d}) + ZDI_o(\beta_{ZDI_o}) + ASC_{T10} + ASC_{CBD} + ASC_{ITC} \\ \qquad + ASC_{JTC} + ASC_{TLH}\)

\(V_{DriveTransit} = IVTT(\beta_{IVTT}) + [OVTT_w(\beta_{OVTT_w}) + OVTT_t(\beta_{OVTT_t}) + OVTT_{dr}(\beta_{OVTT_{dr}})] \\ \qquad + T(\beta_T) + ZTI(\beta_{ZTI}) + ZDI_d(\beta_{ZDI_d}) +DIS_{15}(\beta_{DIS_{15}})+ ASC_{T10} + ASC_{CBD} + ASC_{ITC} \\ \qquad + ASC_{JTC} + ASC_{TLH}\)

\begin{itemize}
\tightlist
\item
  \(IVTT\) is the in-vehicle travel time (min); \(\beta_{IVTT}\) is different depending on which transit mode is selected,
\item
  \(OVTT_w\) is the initial wait time (min); \(\beta_{OVTT_w}\) is different depending on if \(OVTT_w\) is above or below 10 minutes,
\item
  \(OVTT_{dr}\) is the drive to transit time (min),
\item
  \(OVTT_t\) is the transfer wait time travel time (min),\\
\item
  \(ASC_{OVTT_d}\) is the destination walk time constant; different depending on short or long walk to destination,
\item
  \(ASC_{OVTT_o}\) is the origin walk time constant; different depending on short or long walk from origin,
\item
  \(T\) is the number of transfers,
\item
  \(ZTI\) is the zonal topography index at the destination,
\item
  \(ZDI_d\) is the zonal density index at the destination,
\item
  \(ZDI_o\) is the zonal density index at the origin,
\item
  \(DIS_{15}\) is the number of miles less than 15,
\item
  \(ASC_{T10}\) is a demographic variable for individuals under 10 years old,
\item
  \(ASC_{CBD}\) is a constant used if the destination is in CBD for area types 0 and 1,
\item
  \(ASC_{ITC}\) is an individual tour constant; different depending on ratio of number of cars to number of workers,
\item
  \(ASC_{JTC}\) is a joint tour constant; different depending on ratio of number of cars to number of workers, and
\item
  \(ASC_{TLH}\) is the transit line-hail mode constant; different depending on which transit mode is selected.
\end{itemize}

\hypertarget{lit42}{%
\subsection{ActivitySim's Trip Mode Choice Model}\label{lit42}}

The trip mode choice model assigns a specific mode to each trip on a given tour. It is similar to the tour mode choice model, except only certain trips are allowed depending on the tour mode. Figure \ref{fig:fig2} displays a detailed explanation of which trip modes are allowed according to the tour mode that was selected in the tour mode choice.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{pics/trip_allow} 

}

\caption{Trip Mode Availability based on Tour Mode (MTC 2012).}\label{fig:fig2}
\end{figure}

The rules that define the correspondence between trips and tours are defined as the following: (MTC 2012)

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Pay trip modes are only allowed under pay tour modes. For example, Shared Ride 2 (Pay) is only an available trip under the tour mode Shared Ride 2 (Pay).
\item
  The auto occupancy for the tour mode is determined by the maximum auto occupancy among all the auto trips within the tour. Therefore, the tour mode's auto occupancy is the trip with the largest auto occupancy within the tour.
\item
  Transit tours do allow auto-shared (carpooling) trips for particular legs. For example, if someone takes an auto-shared trip to work, the mode choice structures allows the individual to take transit back home.
\item
  The walk mode is an allowed mode for any given trip, no matter the tour.
\item
  ``The availability of transit line-haul submodes on transit tours depends on the skimming and tour mode choice hierarchy'' (MTC 2012). Albeit a low probability, free shared-ride trip modes are allowed in walk-transit tours. Paid shared-ride trip modes are not allowed, however, on transit tours because no evidence promotes this mode selection
\end{enumerate}

The utility function equations used for the trip mode choice model are shown in Section \ref{lit421}. These parameters are very similar to the ones used in the tour mode choice model. In most cases, the in-vehicle times for coefficients in the trip mode choice are identical with the in-vehicle times in the tour mode choice. For coefficients of variables that apply in the trip mode choice to multiple legs, but only apply once in the tour mode choice, the trip mode choice in-vehicle time is half that of the tour mode choice in-vehicle time.

The trip is determined using a nested logit model structure, just like the tour mode choice model. There is one for each tour purpose as well. Notice how it is based on \emph{tour} purpose and not each \emph{trip} purpose.

\hypertarget{lit421}{%
\subsection{ActivitySim's Trip Mode Choice Utility Functions}\label{lit421}}

The utility functions for the auto, nonmotorized, and transit modes are presented in this section. All \(\beta\) and \(ASC\) values are meant to represent parameter values. All other variables are dependent on other things, like time for example. (The utility equations are deduced from information from MTC (2012)).

\textbf{Auto}

\(V_{DriveAlone} = IVTT(\beta_{IVTT})\)

\(V_{Shared2} = IVTT(\beta_{IVTT}) + OVTT_w(\beta_{OVTT_w}) + ASC_{HHS} + ASC_{ITC}[TM_{S2}, TM_{S3P}, TM_T]\)

\(V_{Shared3P} = IVTT(\beta_{IVTT}) + OVTT_w(\beta_{OVTT_w}) + ASC_{HHS} + ASC_{ITC}[TM_{S3P}, TM_T]\)

\begin{itemize}
\tightlist
\item
  \(IVTT\) is the in-vehicle travel time (min),
\item
  \(OVTT_w\) is the initial wait time (min); \(\beta_{OVTT_w}\) is different depending on if \(OVTT_w\) is above or below 10 minutes,
\item
  \(ASC_{HH}\) is a demographic variable for household size; only used if the household size is 1,
\item
  \(ASC_{ITC}\) is an individual tour constant,
\item
  \(TM_{S2}\) is a tour mode indicator for the Shared2 mode (1 if the tour mode is Shared2 and 0 if not),
\item
  \(TM_{S3P}\) is a tour mode indicator for the Shared3P mode(1 if the tour mode is Shared3P and 0 if not), and
\item
  \(TM_{T}\) is a tour mode indicator for a Transit mode(1 if the tour mode is Transit and 0 if not)
\end{itemize}

\textbf{NonMotorized}

\(V_{Walk} = DIS(\beta_{DIS}) + ZTI(\beta_{ZTI}) + ZDI_d(\beta_{ZDI_d}) + ZDI_o(\beta_{ZDI_o}) \\ \qquad+ ASC_{ITC}[TM_{DA}, TM_{S2}, TM_{S3P}, TM_{B}, TM_{T}]\)

\(V_{Bike} = DIS(\beta_{DIS}) + ZTI(\beta_{ZTI}) + ZDI_d(\beta_{ZDI_d}) + ZDI_o(\beta_{ZDI_o})\)

\begin{itemize}
\tightlist
\item
  \(DIS\) is the distance travled (miles); \(\beta_{DIS}\) is different depending on if \(DIS\) is above or below 1.5 miles for walk and 6 miles for bike,
\item
  \(ZTI\) is the zonal topography index at the destination,
\item
  \(ZDI_d\) is the zonal density index at the destination,
\item
  \(ZDI_o\) is the zonal density index at the origin,
\item
  \(ASC_{ITC}\) is an individual tour constant,
\item
  \(TM_{DA}\) is a tour mode indicator for the DriveAlone mode (1 if the tour mode is DriveAlone and 0 if not),
\item
  \(TM_{S2}\) is a tour mode indicator for the Shared2 mode (1 if the tour mode is Shared2 and 0 if not),
\item
  \(TM_{S3P}\) is a tour mode indicator for the Shared3P mode(1 if the tour mode is Shared3P and 0 if not), and
\item
  \(TM_{B}\) is a tour mode indicator for the Bike mode (1 if the tour mode is Bike and 0 if not), and
\item
  \(TM_{T}\) is a tour mode indicator for a Transit mode(1 if the tour mode is Transit and 0 if not)
\end{itemize}

\textbf{Transit}

\(V_{WalkTransit} = IVTT(\beta_{IVTT}) + [OVTT_w(\beta_{OVTT_w}) + OVTT_t(\beta_{OVTT_t}) + ASC_{OVTT_d} + ASC_{OVTT_o}] \\ \qquad + T(\beta_T) + ZTI(\beta_{ZTI}) + ZDI_d(\beta_{ZDI_d}) + ZDI_o(\beta_{ZDI_o}) + ASC_{ITC}[TM_T]\)

\(V_{DriveTransit} = IVTT(\beta_{IVTT}) + [OVTT_w(\beta_{OVTT_w}) + OVTT_t(\beta_{OVTT_t}) + OVTT_{dr}(\beta_{OVTT_{dr}})] \\ \qquad + T(\beta_T) + ZTI(\beta_{ZTI}) + ZDI_d(\beta_{ZDI_d}) + ASC_{ITC}[TM_T]\)

\begin{itemize}
\tightlist
\item
  \(IVTT\) is the in-vehicle travel time (min); \(\beta_{IVTT}\) is different depending on which transit mode is selected,
\item
  \(OVTT_w\) is the initial wait time (min); \(\beta_{OVTT_w}\) is different depending on if \(OVTT_w\) is above or below 10 minutes,
\item
  \(OVTT_{dr}\) is the drive to transit time (min),
\item
  \(OVTT_t\) is the transfer wait time travel time (min),\\
\item
  \(ASC_{OVTT_d}\) is the destination walk time constant; different depending on short or long walk to destination,
\item
  \(ASC_{OVTT_o}\) is the origin walk time constant; different depending on short or long walk from origin,
\item
  \(T\) is the number of transfers,
\item
  \(ZTI\) is the zonal topography index at the destination,
\item
  \(ZDI_d\) is the zonal density index at the destination,
\item
  \(ZDI_o\) is the zonal density index at the origin,
\item
  \(ASC_{ITC}\) is an individual tour constant; different depending which transit mode is selected, and
\item
  \(TM_{T}\) is a tour mode indicator for a Transit mode(1 if the tour mode is Transit and 0 if not)
\end{itemize}

\hypertarget{lit5}{%
\section{The Mode Choice Models used in Agent-based Models}\label{lit5}}

Thus far, an extensive review of mode choice in activity-based models as well as the tour and trip mode choice choice models in Activitysim has been conducted. It is clear that an overarching tour mode value is essential to mode choice trip estimation in activity-based models. In ActivitySim, a multitude of person, path, and location variables are also needed to estimate accurate mode choice decisions.

As a comparison, we will now review the mechanics of mode choice in agent-based models / microsimulation tools. In Section \ref{lit6} the mode choice model of the agent-based model MATSim is discussed. Then, in Section \ref{lit7} the mode choice model of the agent-based model BEAM is discussed. The BEAM microsimulation tool is the agent-based mode used extensively this research.

\hypertarget{lit6}{%
\section{The Mode Choice Model used in MATSim}\label{lit6}}

Microsimulation is a modeling tool used to simulate individual vehicle movement across a network for the purpose of evaluating the traffic performance of the entire system. MATSim, as mentioned in Section @ref(lit3.7), is an example of a microsimulation tool used today and implements a unique mode choice model.

W Axhausen, Horni, and Nagel (2016) explains that mode choice in MATSim, along with time choice, destination choice, and route assignment, are chosen through an iterative cycle where every agent optimizes its daily activity pattern by picking the best option each cycle. After multiple iterations, the optimal choice is selected. Specifically, it uses scoring functions (the Charypar-Nagel utility function) to help determine the optimal choice for each iteration. Equation \eqref{eq:eq1} shows the basic form of the Charypar-Nagel Function used in MATSim (W Axhausen, Horni, and Nagel 2016).

\begin{equation} 
  S_{plan} = \sum_{q=0}^{N-1} S_{act,q} + \sum_{q=0}^{N-1} S_{trav,mode(q)}
  \label{eq:eq1}
\end{equation}

In the Charypar-Nagel utility function, \(S_{plan}\) represents the utility of a plan, \(S_{act,q}\) represents the sum of all the activity utilities, and \(S_{trav,mode(q)}\) represents the sum of all the travel ``(dis)utilities'' (W Axhausen, Horni, and Nagel 2016). In other words, the plan's utility is computed from adding the activity utilities and subtracting the mode and travel utilities.

During each iteration, a new plan for the agent is calculated, resulting in different travel and mode values selected. After each iteration, the plan with the best overall ``score'' or utility is selected probabilistically among the previous and current iteration utility plans. As discussed in Section \ref{lit37}, MATSim continues to iteratively update mode choice until schotastic equilibrium is reached (Hasnine and Nurul Habib 2021). This action of determining the best modal alternative over a simulation process proves that the mode choice model is a mix of a simulation-based model (Section \ref{lit35}) and a dynamic tour-based model (Section \ref{lit37}).

MATSim's mode choice program contrasts greatly from ActivitySim's mode choice model. Various efforts have been proposed to create a more advanced mode choice model system in MATSim. These efforts will be further explained in Section \ref{lit8}. First, Section \ref{lit7} explores the mode choice model of a different microsimulation tool named BEAM.

\hypertarget{lit7}{%
\section{The Mode Choice Model used in BEAM}\label{lit7}}

Another microsimulation tool, similar to MATSim, is BEAM. BEAM stands for Beahvior, Energy, Autonomy, and Mobility and is being developed at the Lawrence Berkely National Laboratory. According to El Zarwi, Vij, and Walker (2017), BEAM's framework is designed to model and forecast the adoption and diffusion of new transportation services. Originally, BEAM implemented a Latent Class Choice Model (LCCM) as the mode choice structure to more accurately model early adopters, imitators, and non-adopters of the new transportation services. BEAM's user guide, however, explains that the LCCM model is not currently being used, and instead something similar to a nested multinomial logit model is in effect. The observed utility function for the multinomial logit model includes parameters relating to travel time, cost, and a constant term.

BEAM's mutlinomial logit model takes in certain parameters and inputs and uses them to probabilistically estimate the likely mode choice for each user in their repsective situation. Mathematically, the observerable utility equation for the simple multinomial logit model in BEAM is shown in Equation \eqref{eq:beammnl}.

\begin{equation}
  V_j = ASC_j + \beta_{cost}(cost) + \beta_{time}(time) + \beta_{xfer}(numtransfers) 
    \label{eq:beammnl}
\end{equation}

where

\begin{itemize}
\tightlist
\item
  \(j\) is the modal alternative,
\item
  \(V_j\) is the obervable portion of the utility equation,
\item
  \(ASC_j\) is the alternative specific constant, and
\item
  \(\beta_{cost}\), \(\beta_{time}\), and \(\beta_{xfer}\) are generic coefficients for the cost, time, and number of transfer parameters.
\end{itemize}

All things considered, the observable utility equation for BEAM's multinomial logit model is pretty simple. There are only three \(\beta\) coefficients along with one alternative specific constant. Also, in BEAM, utility equations are specific to different mode options. For example, the utility for car, walk, bike, etc. will all be different. Yes Equation \eqref{eq:beammnl} shows the overarching utility equations, but the alternative specific constant differs between different modes.

A total of nine different modal alternatives are available in BEAM. Unlike ActivitySim, no tour-mode structure exists. BEAM's mode choice is designed on a trip-based system. Figure \ref{fig:fig-mode-compare} highlights how BEAM's trip-based mode choice works and summarizes the difference between ActivitySim's mode choice and BEAM's mode choice.

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{pics/asim-beam-compare} 

}

\caption{Mode choice between ActivitySim and BEAM.}\label{fig:fig-mode-compare}
\end{figure}

ActivitySim provides mode choices off of the primary tour activity. For example, referring to in Figure \ref{fig:fig-mode-compare}, if a person wants to go to their work activity by train, ActivitySim knows that they can either walk or take transit to their gym activity. Contrastingly, BEAM bases mode choice on the first trip of the day. This means that BEAM will determine the optimal mode to go to the gym in, and then figure our how to get to work based on the first trip mode. In addition, ActivitySim knows that when a person leaves for lunch from their work activity, they will be returning back to their work activity after lunch. This means that the person is able to leave their car at work and possibly walk or take transit to and from their lunch activity. In BEAM though, if someone goes to lunch, they will most likely take their car as to not abandon their vehicle for the rest of their day. It is clear that BEAM's mode choice is less representative of how people actually transport themselves during the day. ActivitySim provides a better representation of mode choice. As a result, it is important to improve the mode choice model in BEAM (See Section \ref{lit8}). In addition, in this research we explore the importance of creating consistency between the mode choice models between BEAM and ActivitySim (See Section \ref{lit9}).

\hypertarget{lit8}{%
\section{Previous Attempts to Enhance Mode Choice in Agent-based Models}\label{lit8}}

In recent years, suggestions have been made on how to improve MATSim's mode choice structure. Axhausen, Balmer, and Ciari (2008) proposed introducing discrete choice, in the form of multinomial logit models, on the subtour level of mode choice. Currently, MATSim's mode choice is performed at the tour level, meaning subtour mode choice is limited. This new introduction would allow variation in mode on all subtours. Similarly, Hörl, Balac, and Axhausen (2018) proposed updating upon a subtour mode choice model to eliminate heavily randomized processes and to increase the use of realistic subtour modal options.

In addition to improving the subtour mode choice strategy within MATSim, Hörl, Balac, and Axhausen (2018) also proposed introducing a chain-based modal selection model, similar to the type of model discussed in Section \ref{lit36}. Hörl, Balac, and Axhausen (2018) describes this chain-based model with, ``If one iterates over all possible combinations of modes on these trips, one arrives at a set of available mode chains C of size \(M^{N}\), where \(M\) is the number of possible modes and \(N\) is the number of trips.'' The resulting set of feasible chains \(C_f \in C\) could look as follows:

\begin{equation} 
  C_f = \{(car,car,car),(transit,transit,transit),(transit,walk,transit),...\}
  \label{eq:eq2}
\end{equation}

Equation \eqref{eq:eq2} provides a great example of all the chain-based modal alternatives that would exist in the choice set. In order to model the chain selection, Hörl, Balac, and Axhausen (2018) suggest incorporating ``an out-of-the-box discrete mode choice model into MATSim''. They propose that this discrete choice model would involve two sampling approaches. The first approach invovles calculating the total utility value for the chain-based modes and the other would be based on individual trip probabilities. In order to calculate the utility however, various variables like travel time and travel costs would be involved. The downside to this model, however, would be that analyzing the chain-based modes and a calculating individual utilities would cause significant computational overhead compared to MATSim's default mode choice model.

In the work done by Hörl, Balać, and Axhausen (2019), a discrete choice model is actually inserted into MATSim and tested using a case study of the city of Zurich. In this model, both a trip based and a tour based mode choice model are used. The tour based model is identical to the chain-based model described in the work done by Hörl, Balac, and Axhausen (2018). A multinomial logit model is used to probabilistically select between the utility values of each modal alternative. With the introduction of discrete choice and chain-based tour mode choice into MATSim, Hörl, Balać, and Axhausen (2019) states that there is better convergence behavior. Since mode choice is not done at random and no irrational modal decisions are being made, this newer model arrives at convergence with fewer iterations. However, since more explanatory variables are needed to estimate mode choice, extensive calibration is required in order to ensure the mode choice model performs in an unbiased manner.

Hörl, Balać, and Axhausen (2019) found that the advanced trip-based model resulted in a more accurate mode share by time of day than the simple trip-based model. It was also determined that run time was higher with the advanced trip-based mode. Overall, the introduction of discrete choice and chain-based tour mode choice into MATSim could result in scenarios with quicker convergence, more accurate modal shares, and higher run times.

Since BEAM is a new agent-based model that is still being developed regularly, not many proposals have been made to improve its mode choice model. However, one example in the literature of a mode choice improvement to BEAM is done by Barth et al. (2020). Barth et al. (2020) proposed that BEAM implements a fundamental influencing factor (FIF) mode choice model instead of the original LCCM or the current MNL. The primary goal of the FIF model would be to calibrate the model against data on people's actual travel decisions while simultaneously allowing the introduction of any hypothetical mode. The FIF model would still implement an LCCM by grouping individuals into different classes based on a logit function. The logit utility function, however, would include seven parameters; this makes the influencing factors more than twice that of BEAM's current function. Overall, this new model would make BEAM more effective at estimating the usage of new transportation services, but the structure would be vastly different than many activity-based models.

The research we present is another idea of how to improve the mode choice model in the agent-based tool BEAM. This proposed improvement is discussed in Section \ref{lit9} and revolves around the idea of creating consistency between actiivy-based models and microsimulation tools.

\hypertarget{lit9}{%
\section{Mode Choice Consistency between ActivitySim and BEAM}\label{lit9}}

Oftentimes, the outputs of an activity-based model will serve as the inputs to a microsimulation tool. However, as discussed in Section \ref{lit3} activity-based models can include a wide range of mode choice modeling. Usually the mode choice models within activity-based models rely on a tour-mode choice first, followed by trip-mode choice. Mode choice models within activity-based models are usually more thorough than mode choice models in microsimulation tools. As discussed in Section \ref{lit6} MATSim simply uses a scoring function to determine mode decisions; after each iteration a new option is explored. In Section \ref{lit7}, BEAM's mode choice model was explained as a simly multinomial logit model with only a few parameters. Overall, the mode choice structures within activity-based models and microsimulation tools differ between each other.

Currently, there exists a gap in the literature with understanding the effects of a consistent mode choice model between an activity-based model and a microsimulation tool. Since its possible for the outputs of an activity-based model to be used as the inputs of a microsimulation tool, it would make intuitive sense that the structure for estimating mode choice would be held constant. However, this is not the case; mode choice models differ between different travel forecasting tools.

We propose to make a consistent mode choice model between an activity-based model and a microsimulation tool. Specifically, we propose to align BEAM's current multinomial logit mode choice model with ActivitySim's mode choice model. This will involve calculating the utility of each modal alternative in BEAM with the same path, person, and location variables that ActivitySim uses. In other words, the utility function for each modal alternative will be the same between both models. In addition, we will add a few new mode options in BEAM to allow for the ability to carpool. This new model will include basing utility parameters off of tour purpose values. Lastly, it would be ideal to develop a tour mode choice structure within BEAM; however, a tour-based mode choice model will not be discussed within this project because of the complexity of adding this in the BEAM code framework.

We aim to better understand the effects of a consistent mode choice model between an activity-based model and a microsimulation tool. We will do this by upgrading the mode choice model in BEAM to be more closely aligned with that of ActivitySim. We will then explore the outputs and compare the effects of the new mode choice model and the original mode choice model. Chapter 4 explains the methodology of how we accomplished this task.

\hypertarget{methods}{%
\chapter{Methods}\label{methods}}

\hypertarget{overview-1}{%
\section{Overview}\label{overview-1}}

A systematic approach to determine the effects of a consistent mode choice model between an activity-based model and a microsimulation tool requires two main steps. The first step involves creating a test scenario that runs within the activity-based model ActivitySim and the microsimulation tool BEAM. Section \ref{mscen} explains this step including how the test scenario was created and how ActivitySim and BEAM were configured. The second step involves adjusting the internal code of BEAM to align the mode choice model with that of ActivitySim's. Section \ref{mbeam} explains the details behind the changes made to BEAM's default mode choice model to align more closely with that of ActivitySim's.

\hypertarget{mscen}{%
\section{Creating and Setting up the Test Scenario}\label{mscen}}

Designing a test scenario to use within ActivitySim and BEAM was essential to understanding and testing mode choice between models. This section explains the region that was used to model the test scenario. This section also explains how the input files needed to run both ActivitySim and BEAM were generated for the test scenario.

\hypertarget{test-scenario-region}{%
\subsection{Test Scenario Region}\label{test-scenario-region}}

The test scenario used in this research includes the approximate 2.5 million agents of the Salt Lake City, Utah, USA region. This region includes the Box Elder, Davis, Salt Lake, Utah, and Weber counties. Figure \ref{fig:figregion} shows the 2881 Traffic Analysis Zones (TAZs) along with the five counties that make up the region of study.

This extensive region was selected for the following reasons:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  There is substantial data that exists for this region. Having sufficient data points for each of the TAZs was essential to creating the inputs to ActivitySim and BEAM. The majority of the data used for this research was gathered and shared by Wasatch Front Regional Council (WFRC), the Metropolitan Planning Organization (MPO) of Salt Lake county.
\item
  There currently exists a need to analyze this region with a microsimulation tool, such as BEAM. Specifically, the Utah Transit Authority (UTA) wishes to understand what specific sub regions in the Salk Lake area will best serve new on-demand transit vehicles. In some future research, this specific question will be answered. Along this this question, having a microsimulation model of a region will prove to be an effective method to answering multiple transportation service questions in the future. To date, only one previous analysis of this region has been conducted with the BEAM software (Lant 2021).
\item
  The size and population within the study area are comparable to other regions around the United States. This means that the work completed in this research may be useful to other cities besides Salt Lake City.
\item
  The project researchers live in this region, and therefore have real life knowledge of how transportation works in the region. This allows the researchers to compare the the results of the models with their own experiences, hopefully providing extra verification.
\end{enumerate}

Overall, the Salt Lake City, Utah region proved to be an effective location for this mode choice analysis research. After selecting the region of study, the next steps involved seting up and running ActivitySim.

\hypertarget{setting-up-and-running-activitysim}{%
\subsection{Setting up and Running ActivitySim}\label{setting-up-and-running-activitysim}}

Setting up and running ActivitySim for the Salt Lake region was an arduous task. The entire process for setting up the activity-based model for this region is explained in the research done by Lant (2021). The research done by Lant (2021) was the basis to the work completed in this project.

However, a brief explanation of the setup of the activity-based model is explained in Section \ref{asiminput}. The two main steps behind creating an activity-based mode for the Salt Lake region was creating corresponding input files and calibrating and validating the results.

\hypertarget{asiminput}{%
\subsubsection{Creating Input Files}\label{asiminput}}

ActivitySim requires the following three input files in order to run:

\begin{itemize}
\tightlist
\item
  A synthetic population of the agents within the study area.
\item
  A zonal socioeconomic data file describing the characteristics of each zone.
\item
  A set of skims that describe the cost and travel times of all modes between all zones.
\end{itemize}

The synthetic population is used to generate an entire population with specific individual details for each agent (like gender, age, income, vehicle ownership). Gathering individual information for all the agents in the region may be considered an invasion of privacy. So instead a synthetic population is used. The synthetic population is a generated population with specific individual attributes that add up to the regional characteristics as a whole. The synthetic population was generated using a software called PopulationSim (PopulationSim 2021). To run PopulationSim a ``seed'' table and a set of ``targets'' were used. The ``seed'' table represented information about a subset of the population and the set of ``targets'' represented demographic data for smaller areas within the region (Lant 2021). Together, PopulationSim was able to simulate individual attributes for the approximate 2.5 million agents in the Salt Lake region.

The zonal socioeconomic data file stores zonal characteristics regarding household information, worker information, and other activity type information. This file specifically gives information on what types and how many types of activities may be found within a certain zonal region. This file was created using data from WFRC, Utah Automated Geographic Reference Center (AGRC 2021), and the synthetic population when necessary.

The third input to ActivitySim is detailed travel skims. Skims are large matrices showing travel times and costs between every set of zones within the area of study. Included in these skims were further details regarding differences in modes, distances, wait times, etc. (Lant 2021). The existing skims from WFRC were used along with some slight adjustments to fit the ActivitySim model.

\hypertarget{asimcal}{%
\subsubsection{Calibration and Validation}\label{asimcal}}

The calibration and validation of ActivitySim was conducted by Lant (2021). The purpose of the calibration and validation was to ensure the outputs generated by ActivitySim matched target regional values. Specifically trip productions, trip distributions, and mode choices were tested to match the given target values from WFRC's four-step model.

To validate the trip productions, total trips per county were compared between ActivitySim and WFRC target values. These trips were close to identical, with only a variation of 1.0 percent. The trip distributions were compared as well, with about a 4.0 percent margin of error. Overall, Lant (2021) shows that the trip productions and distributions of the ActivitySim model were a good representation of travel behavior, requiring no calibration.

The mode choice validation was difficult as the mode choice categories between WFRC and ActivitySim are vastly different. ActivitySim considers five trip mode choice alternatives whereas the WFRC model considers 10 trip mode choice alternatives. However, ActivitySim does include 10 tour mode choice alternatives. When comparing mode choice distributions, both the trip and tour distributions from ActivitySim were compared with the trip distributions of WFRC. Lant (2021) performs an in depth comparison between these values and found that ActivitySim underrepresents non-motorized university trips and overrepresents non-motorized work trips. In addition ActivitySim underrepresents shared ride trips for all tour purposes and does not accurately represent commuter rail and local bus trips for all tour purposes. overall, the mode choice model did not match closely with the WFRC targets, and required further calibration.

Lant (2021) performed an in depth calibration across ActivitySim modes to minimize error with the WFRC target shares. The calibration process will not be explained in this research paper however. Upon calibration, trip productions and distributions remained relatively unchanged, and therefore needed no calibration. Mode choice distributions were closer to target values as well. Overall, after some calibration the results of ActivitySim produced sufficiently accurate information to move forward with the research.

\hypertarget{setting-up-beam}{%
\subsection{Setting up BEAM}\label{setting-up-beam}}

After setting up, calibrating, and running the ActivitySim scenario for the Salt Lake region, the next step was setting up BEAM using the results of the ActivitySim model. BEAM requires a variety of input files, most of which are as follows:

\begin{itemize}
\tightlist
\item
  A person population and corresponding person attributes files.
\item
  A household population with household attributes file and a vehicle fleet file.
\item
  Vehicle types files explaining different person vehicle types, public transit vehicle types, and ride hailing vehicle information.
\item
  Transportation services including a mapable street network and a file including General Transit Feed Specification (GTFS) transit information.
\item
  Other minor input files.
\end{itemize}

The BEAM input files were directly creating using the generate\_beam\_plans.py python script ActivitySim add on. This script was developed by the developers at Lawrence Berkeley National Lab, and allows easy csv formatted input files to BEAM. The details behind these input files along with example tables of these files are discussed and shown in the following subsections.

\hypertarget{population-file}{%
\subsubsection{Population File}\label{population-file}}

The population file was created from the ActivitySim generated data. ActivitySim's main purpose is to generate daily activity patterns (DAPs) for each agent from the synthetic population. The DAPs generated by ActivitySim consists of all the activities that each agent within the population embark on during the day. Using the activity types, activity locations, activity durations, mode choices, departure and arrival times, and overall activity data, BEAM generated a population file along with a person attributes file.

The population file generated by the BEAM ActivitySim add-on code created a csv file describing all the events and choices each agent embarks on during the plan. For example, the plans file defines each agents home location, their activity locations, their travel and activity times, their mode choices for each trip, etc. A subsection of this file is shown in Table \ref{tab:plans} to provide an example of some of its contents.

\begin{table}

\caption{\label{tab:plans}A Subset of the Population Plans}
\centering
\begin{tabular}[t]{rllrlrrr}
\toprule
ID & Mode & Type & End Time & Purpose & Household ID & LocaitonX & LocaitonY\\
\midrule
50 & NA & Home & 25668.0 & escort & 6 & 412577.3 & 4606340\\
50 & hov3 & NA & NA & escort & 6 & NA & NA\\
50 & NA & escort & 28170.0 & escort & 6 & 413589.0 & 4593487\\
50 & hov3 & NA & NA & escort & 6 & NA & NA\\
50 & NA & home & NA & escort & 6 & 412577.3 & 4606340\\
\addlinespace
51 & NA & Home & 36079.2 & work & 6 & 412092.6 & 4606274\\
51 & car & NA & NA & work & 6 & NA & NA\\
51 & NA & escort & 38109.6 & work & 6 & 418892.5 & 4567448\\
51 & car & NA & NA & work & 6 & NA & NA\\
51 & NA & work & 64998.0 & work & 6 & 424344.6 & 4537656\\
\addlinespace
51 & car & NA & NA & work & 6 & NA & NA\\
51 & NA & escort & 70578.0 & work & 6 & 409491.7 & 4552587\\
51 & car & NA & NA & work & 6 & NA & NA\\
51 & NA & home & NA & work & 6 & 412092.6 & 4606274\\
52 & NA & Home & 67010.4 & othdiscr & 6 & 412437.5 & 4606445\\
\bottomrule
\end{tabular}
\end{table}

The person attributes file describes individual characteristics such as income, gender, age, vehicle ownership, etc. A subsection of this file is shown in Table \ref{tab:peratt} to provide an example of some of its contents.

\begin{table}

\caption{\label{tab:peratt}A Subset of the Person Attributes File}
\centering
\begin{tabular}[t]{rrrrrrrrl}
\toprule
ID & Household ID & Age & Sex & VOT & TAZ & Income & Household Size & Auto Work Ratio\\
\midrule
50 & 6 & 50 & 2 & 9.518956 & 9 & 103337.40 & 10 & auto\_sufficient\\
51 & 6 & 56 & 1 & 9.518956 & 9 & 103337.40 & 10 & auto\_sufficient\\
52 & 6 & 35 & 2 & 9.518956 & 9 & 103337.40 & 10 & auto\_sufficient\\
53 & 6 & 23 & 2 & 9.518956 & 9 & 103337.40 & 10 & auto\_sufficient\\
54 & 6 & 15 & 2 & 6.349144 & 9 & 103337.40 & 10 & auto\_sufficient\\
\addlinespace
55 & 6 & 11 & 1 & 6.349144 & 9 & 103337.40 & 10 & auto\_sufficient\\
56 & 6 & 5 & 1 & 6.349144 & 9 & 103337.40 & 10 & auto\_sufficient\\
57 & 6 & 2 & 1 & 6.349144 & 9 & 103337.40 & 10 & auto\_sufficient\\
58 & 6 & 1 & 1 & 6.349144 & 9 & 103337.40 & 10 & auto\_sufficient\\
59 & 6 & 43 & 1 & 9.518956 & 9 & 103337.40 & 10 & auto\_sufficient\\
\addlinespace
599 & 58 & 71 & 1 & 8.431196 & 5 & 52461.37 & 9 & auto\_sufficient\\
600 & 58 & 63 & 2 & 8.431196 & 5 & 52461.37 & 9 & auto\_sufficient\\
601 & 58 & 35 & 2 & 8.431196 & 5 & 52461.37 & 9 & auto\_sufficient\\
602 & 58 & 23 & 2 & 8.431196 & 5 & 52461.37 & 9 & auto\_sufficient\\
603 & 58 & 16 & 1 & 5.623608 & 5 & 52461.37 & 9 & auto\_sufficient\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{household-and-vehicle-files}{%
\subsubsection{Household and Vehicle Files}\label{household-and-vehicle-files}}

The household and vehicle files were generated using the same code to generate the population files. ActivitySim generates three specific files: a households, persons, and trips file. The persons and trips files were used to construct the population plans file. The households file, however, was used to generate both the household and vehicle BEAM input files.

Within the BEAM households file, information such as household income, vehicle ownership, and the IDs of the agents and vehicles that correspond to each household ID is provided. Unfortunately, ActivitySim does not generate household coordinate locations, but does provide the TAZ in which the house presides. Therefore, the generate\_beam\_plans.py code designed by the BEAM developers assigns a random coordinate within the TAZ to each house. This household coordinate is then used to simulate starting and ending locations for each agent within their population plans file. An example of a subset of the households file that is used as an input to BEAM is shown in Table \ref{tab:house}.

\begin{table}

\caption{\label{tab:house}A Subset of the Households File}
\centering
\begin{tabular}[t]{rrrrrrl}
\toprule
Household ID & TAZ & Income & Household Size & LocationX & LocationY & Auto Work Ratio\\
\midrule
304379 & 1281 & 37362.029 & 8 & 419080.7 & 4498686 & auto\_sufficient\\
270209 & 1104 & 163050.420 & 4 & 426367.4 & 4506262 & auto\_sufficient\\
68811 & 555 & 17291.518 & 3 & 428645.4 & 4524432 & auto\_sufficient\\
83245 & 553 & 35756.388 & 2 & 426902.8 & 4523207 & no\_auto\\
373813 & 1516 & 54036.582 & 2 & 430560.8 & 4491969 & auto\_sufficient\\
\addlinespace
574302 & 341 & 68375.208 & 4 & 418986.0 & 4559249 & no\_auto\\
253735 & 1197 & 192125.910 & 2 & 431933.2 & 4504105 & auto\_sufficient\\
53111 & 473 & 21239.420 & 2 & 420837.4 & 4542079 & auto\_sufficient\\
366644 & 1481 & 13778.640 & 2 & 429353.8 & 4494406 & no\_auto\\
101334 & 666 & 9777.942 & 2 & 422532.8 & 4514347 & auto\_sufficient\\
\bottomrule
\end{tabular}
\end{table}

The vehicles file is quite simple in that it only includes information on the vehicle ID, vehicle type, and the household the vehicle belongs to. An example of a subset of the vehicles file that is used as an input to BEAM is shown in Table \ref{tab:veh}.

\begin{table}

\caption{\label{tab:veh}A Subset of the Vehicles File}
\centering
\begin{tabular}[t]{rlr}
\toprule
Vehicle ID & Vehicle Type & Household ID\\
\midrule
1 & CAR & 6\\
2 & CAR & 6\\
3 & CAR & 6\\
4 & CAR & 6\\
5 & CAR & 30\\
\addlinespace
6 & CAR & 30\\
7 & CAR & 30\\
8 & CAR & 30\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{vechile-types-files}{%
\subsubsection{Vechile Types Files}\label{vechile-types-files}}

In addition to the household and vehicle files, two vehicle type files are also needed to run BEAM. The first describes attributes that relate to each vehicle type. For example, some attributes that are included in the vehicle types file is the fuel efficiency, seating capacity, vehicle length, etc. An example of a subset of the vehicle types file that is used as an input to BEAM is shown in Table \ref{tab:vehtypes}.

\begin{table}

\caption{\label{tab:vehtypes}A Subset of the Vehicle Types Input File}
\centering
\begin{tabular}[t]{lrrrll}
\toprule
ID & Seats & Standing Room & Length (m) & Fuel & Vehicle Type\\
\midrule
BODY-TYPE-DEFAULT & 0 & 0 & 0.5 & Food & Body\\
BIKE-DEFAULT & 2 & 0 & 1.5 & gasoline & Bike\\
FAST-BIKE & 2 & 0 & 1.5 & gasoline & Bike\\
Car & 4 & 0 & 4.5 & gasoline & Car\\
CAR & 4 & 0 & 4.5 & gasoline & Car\\
\addlinespace
Car-rh-only & 4 & 0 & 4.5 & gasoline & Car\\
WAV & 6 & 0 & 4.5 & gasoline & Car\\
CAV & 4 & 0 & 4.5 & gasoline & Car\\
BEV & 4 & 0 & 4.5 & electricity & Car\\
PHEV & 4 & 0 & 4.5 & electricity & Car\\
\addlinespace
BUS-DEFAULT & 37 & 20 & 12.1 & diesel & MediumDutyPassenger\\
RAIL-DEFAULT & 801 & 2052 & 129.6 & diesel & MediumDutyPassenger\\
FERRY-DEFAULT & 149 & 0 & 26.0 & diesel & MediumDutyPassenger\\
SUBWAY-DEFAULT & 336 & 864 & 129.6 & electricity & MediumDutyPassenger\\
CABLE\_CAR-DEFAULT & 29 & 31 & 8.4 & electricity & MediumDutyPassenger\\
\addlinespace
TRAM-DEFAULT & 58 & 19 & 14.0 & electricity & MediumDutyPassenger\\
\bottomrule
\end{tabular}
\end{table}

A secondary vehicle types file exists that describes the nature of the ride hail fleet. One particular advantage to the microsimulation tool BEAM is its ability to model on-demand transit vehicles in a realistic manner. Part of creating realistic ride-hailing services is using an input file describing the nature of the fleet of ride-hail vehicles. An example of a subset of the ride-hail vehicle attributes file that is used as an input to BEAM is shown in Table \ref{tab:rhveh}. For this research project, the ride-hail file used was taken from an example BEAM scenario. In the future however, a ride hailing fleet file that accurately depicts the nature of ride hail vehicles in the Salt Lake region will be used. For this research it was not necessary to include, and so a default file was used instead.

\begin{table}

\caption{\label{tab:rhveh}A Subset of the Vehicle Types Input File}
\centering
\begin{tabular}[t]{llrrl}
\toprule
ID & Vehicle Type & Starting Point X & Starting Point Y & Shift Times\\
\midrule
rideHailVehicle-033000 & Car & 414692.0 & 4498566 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-012301 & Car & 418969.2 & 4495377 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-035201 & Car & 422864.0 & 4527397 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-031400 & Car & 430458.0 & 4508789 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-030800 & Car & 417063.9 & 4568028 & \{10:25200\};\{25300:80000\}\\
\addlinespace
rideHailVehicle-016300 & Car & 415844.3 & 4544000 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-033100 & Car & 408380.1 & 4550982 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-061500 & Car & 436159.1 & 4474228 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-032601 & Car & 420785.5 & 4484536 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-015500 & Car & 444235.6 & 4452609 & \{10:25200\};\{25300:80000\}\\
\addlinespace
rideHailVehicle-016400 & Car & 410876.3 & 4506167 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-061400 & Car & 414579.1 & 4485811 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-017601 & Car & 411338.4 & 4548806 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-020700 & Car & 446697.0 & 4437390 & \{10:25200\};\{25300:80000\}\\
rideHailVehicle-010500 & Car & 425560.0 & 4483818 & \{10:25200\};\{25300:80000\}\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{transportation-services}{%
\subsubsection{Transportation Services}\label{transportation-services}}

\hypertarget{other-input-files}{%
\subsubsection{Other Input Files}\label{other-input-files}}

\hypertarget{mbeam}{%
\section{Additions to BEAM}\label{mbeam}}

\hypertarget{purpose-based-decisions}{%
\subsection{Purpose-based Decisions}\label{purpose-based-decisions}}

\hypertarget{additional-attributes-in-utility-equation}{%
\subsection{Additional Attributes in Utility Equation}\label{additional-attributes-in-utility-equation}}

\hypertarget{carpool-alternatives}{%
\subsection{Carpool Alternatives}\label{carpool-alternatives}}

\hypertarget{mode-choice-algorithms}{%
\section{Mode Choice Algorithms}\label{mode-choice-algorithms}}

\begin{algorithm}
\caption{Algorithm for Selecting Final Modal Alternative in BEAM}
\begin{algorithmic}[1]
\Require
\State $i : origin$
\State $j : destination$
\State $n: agent$
\State $N: population$
\State $t : trip $
\State $P : plan$
\State $\vec{A}: attributes\:of\:agent$
\State $a: attribute\:value$
\State $\vec{M}(i,j) : Modal\:alternatives$
\State $m : alternative \in M(i,j)$
\State $\vec{U}(\vec{M}(i,j),\vec{A}):Utilities\:for\:alternatives$
\State $u: utility \in \vec{U}(\vec{M}(i,j),\vec{A})$
\State $\vec{c}: attribute\:coefficients$
\State $\mathds{P}: probability$
\State $Mode: chosen\:mode\:for\:agent\:(n)\:on\:trip\:(t)$
\State $f(\vec{X}):$
This function takes a vector of modes and  their probabilities of being chosen. With those probabilities it builds them into a cumulative distribution function, generates a random number and then drops the mode with the closest probability. This process continues until only one mode is left.
\vspace{4pt}\hrule\vspace{5pt}

\State $\vec{M} \equiv \vec{M}(i,j)$
\State $\vec{U} \equiv \vec{U}(\vec{M},\vec{A})$
\For {$n \in N$}
\For {$t \in P$}
\Procedure {DetermineFinalModalAlternative}{$\vec{M}$, $\vec{A}$, $\vec{c}$}
\For {$m \in \vec{M}$}
  \State $u \gets \sum_{a\in \vec{A}} a \times c_a$
  \State $\vec{U} += [m,u]$
\EndFor
\State $S \gets \sum_{u\in \vec{U}}e^u$
\For {$u \in \vec{U}$}
    \State $\mathds{P}(u)\gets e^u / S$
    \State $\vec{B} +=[m, \mathds{P}(u)]$
\EndFor 

\State $Mode \gets f(\vec{B})$

\EndProcedure

\EndFor
\EndFor
\Statex
\end{algorithmic}
\end{algorithm}

\hypertarget{data-and-calibration}{%
\section{Data and Calibration}\label{data-and-calibration}}

\hypertarget{path-person-and-location-analysis}{%
\section{Path, Person, and Location Analysis}\label{path-person-and-location-analysis}}

\hypertarget{results}{%
\chapter{Results}\label{results}}

\hypertarget{discussion}{%
\chapter{Discussion}\label{discussion}}

\hypertarget{conclusions}{%
\chapter{Conclusions}\label{conclusions}}

\hypertarget{about}{%
\chapter{About}\label{about}}

This is a \emph{sample} book written in \textbf{Markdown}. You can use anything that Pandoc's Markdown supports; for example, a math equation \(a^2 + b^2 = c^2\).

\hypertarget{usage}{%
\section{Usage}\label{usage}}

Each \textbf{bookdown} chapter is an .Rmd file, and each .Rmd file can contain one (and only one) chapter. A chapter \emph{must} start with a first-level heading: \texttt{\#\ A\ good\ chapter}, and can contain one (and only one) first-level heading.

Use second-level and higher headings within chapters like: \texttt{\#\#\ A\ short\ section} or \texttt{\#\#\#\ An\ even\ shorter\ section}.

The \texttt{index.Rmd} file is required, and is also your first book chapter. It will be the homepage when you render the book.

\hypertarget{render-book}{%
\section{Render book}\label{render-book}}

You can render the HTML version of this example book without changing anything:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Find the \textbf{Build} pane in the RStudio IDE, and
\item
  Click on \textbf{Build Book}, then select your output format, or select ``All formats'' if you'd like to use multiple formats from the same book source files.
\end{enumerate}

Or build the book from the R console:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bookdown}\SpecialCharTok{::}\FunctionTok{render\_book}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

To render this example to PDF as a \texttt{bookdown::pdf\_book}, you'll need to install XeLaTeX. You are recommended to install TinyTeX (which includes XeLaTeX): \url{https://yihui.org/tinytex/}.

\hypertarget{preview-book}{%
\section{Preview book}\label{preview-book}}

As you work, you may start a local server to live preview this HTML book. This preview will update as you edit the book when you save individual .Rmd files. You can start the server in a work session by using the RStudio add-in ``Preview book'', or from the R console:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bookdown}\SpecialCharTok{::}\FunctionTok{serve\_book}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{cross}{%
\chapter{Cross-references}\label{cross}}

Cross-references make it easier for your readers to find and link to elements in your book.

\hypertarget{chapters-and-sub-chapters}{%
\section{Chapters and sub-chapters}\label{chapters-and-sub-chapters}}

There are two steps to cross-reference any heading:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Label the heading: \texttt{\#\ Hello\ world\ \{\#nice-label\}}.

  \begin{itemize}
  \tightlist
  \item
    Leave the label off if you like the automated heading generated based on your heading title: for example, \texttt{\#\ Hello\ world} = \texttt{\#\ Hello\ world\ \{\#hello-world\}}.
  \item
    To label an un-numbered heading, use: \texttt{\#\ Hello\ world\ \{-\#nice-label\}} or \texttt{\{\#\ Hello\ world\ .unnumbered\}}.
  \end{itemize}
\item
  Next, reference the labeled heading anywhere in the text using \texttt{\textbackslash{}@ref(nice-label)}; for example, please see Chapter \ref{cross}.

  \begin{itemize}
  \tightlist
  \item
    If you prefer text as the link instead of a numbered reference use: \protect\hyperlink{cross}{any text you want can go here}.
  \end{itemize}
\end{enumerate}

\hypertarget{captioned-figures-and-tables}{%
\section{Captioned figures and tables}\label{captioned-figures-and-tables}}

Figures and tables \emph{with captions} can also be cross-referenced from elsewhere in your book using \texttt{\textbackslash{}@ref(fig:chunk-label)} and \texttt{\textbackslash{}@ref(tab:chunk-label)}, respectively.

See Figure \ref{fig:nice-fig}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mar =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{4}\NormalTok{, .}\DecValTok{1}\NormalTok{, .}\DecValTok{1}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(pressure, }\AttributeTok{type =} \StringTok{\textquotesingle{}b\textquotesingle{}}\NormalTok{, }\AttributeTok{pch =} \DecValTok{19}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.8\linewidth]{thesis_files/figure-latex/nice-fig-1} 

}

\caption{Here is a nice figure!}\label{fig:nice-fig}
\end{figure}

Don't miss Table \ref{tab:nice-tab}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\SpecialCharTok{::}\FunctionTok{kable}\NormalTok{(}
  \FunctionTok{head}\NormalTok{(pressure, }\DecValTok{10}\NormalTok{), }\AttributeTok{caption =} \StringTok{\textquotesingle{}Here is a nice table!\textquotesingle{}}\NormalTok{,}
  \AttributeTok{booktabs =} \ConstantTok{TRUE}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:nice-tab}Here is a nice table!}
\centering
\begin{tabular}[t]{rr}
\toprule
temperature & pressure\\
\midrule
0 & 0.0002\\
20 & 0.0012\\
40 & 0.0060\\
60 & 0.0300\\
80 & 0.0900\\
\addlinespace
100 & 0.2700\\
120 & 0.7500\\
140 & 1.8500\\
160 & 4.2000\\
180 & 8.8000\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{parts}{%
\chapter{Parts}\label{parts}}

You can add parts to organize one or more book chapters together. Parts can be inserted at the top of an .Rmd file, before the first-level chapter heading in that same file.

Add a numbered part: \texttt{\#\ (PART)\ Act\ one\ \{-\}} (followed by \texttt{\#\ A\ chapter})

Add an unnumbered part: \texttt{\#\ (PART\textbackslash{}*)\ Act\ one\ \{-\}} (followed by \texttt{\#\ A\ chapter})

Add an appendix as a special kind of un-numbered part: \texttt{\#\ (APPENDIX)\ Other\ stuff\ \{-\}} (followed by \texttt{\#\ A\ chapter}). Chapters in an appendix are prepended with letters instead of numbers.

\hypertarget{footnotes-and-citations}{%
\chapter{Footnotes and citations}\label{footnotes-and-citations}}

\hypertarget{footnotes}{%
\section{Footnotes}\label{footnotes}}

Footnotes are put inside the square brackets after a caret \texttt{\^{}{[}{]}}. Like this one \footnote{This is a footnote.}.

\hypertarget{citations}{%
\section{Citations}\label{citations}}

Reference items in your bibliography file(s) using \texttt{@key}.

For example, we are using the \textbf{bookdown} package (Xie 2021) (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and \textbf{knitr} (Xie 2015) (this citation was added manually in an external file book.bib).
Note that the \texttt{.bib} files need to be listed in the index.Rmd with the YAML \texttt{bibliography} key.

The RStudio Visual Markdown Editor can also make it easier to insert citations: \url{https://rstudio.github.io/visual-markdown-editing/\#/citations}

\hypertarget{blocks}{%
\chapter{Blocks}\label{blocks}}

\hypertarget{equations}{%
\section{Equations}\label{equations}}

Here is an equation.

\begin{equation} 
  f\left(k\right) = \binom{n}{k} p^k\left(1-p\right)^{n-k}
  \label{eq:binom}
\end{equation}

You may refer to using \texttt{\textbackslash{}@ref(eq:binom)}, like see Equation \eqref{eq:binom}.

\hypertarget{callout-blocks}{%
\section{Callout blocks}\label{callout-blocks}}

The R Markdown Cookbook provides more help on how to use custom blocks to design your own callouts: \url{https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html}

\hypertarget{sharing-your-book}{%
\chapter{Sharing your book}\label{sharing-your-book}}

\hypertarget{publishing}{%
\section{Publishing}\label{publishing}}

HTML books can be published online, see: \url{https://bookdown.org/yihui/bookdown/publishing.html}

\hypertarget{pages}{%
\section{404 pages}\label{pages}}

By default, users will be directed to a 404 page if they try to access a webpage that cannot be found. If you'd like to customize your 404 page instead of using the default, you may add either a \texttt{\_404.Rmd} or \texttt{\_404.md} file to your project root and use code and/or Markdown syntax.

\hypertarget{metadata-for-sharing}{%
\section{Metadata for sharing}\label{metadata-for-sharing}}

Bookdown HTML books will provide HTML metadata for social sharing on platforms like Twitter, Facebook, and LinkedIn, using information you provide in the \texttt{index.Rmd} YAML. To setup, set the \texttt{url} for your book and the path to your \texttt{cover-image} file. Your book's \texttt{title} and \texttt{description} are also used.

This \texttt{gitbook} uses the same social sharing data across all chapters in your book- all links shared will look the same.

Specify your book's source repository on GitHub using the \texttt{edit} key under the configuration options in the \texttt{\_output.yml} file, which allows users to suggest an edit by linking to a chapter's source file.

Read more about the features of this output format here:

\url{https://pkgs.rstudio.com/bookdown/reference/gitbook.html}

Or use:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{?bookdown}\SpecialCharTok{::}\NormalTok{gitbook}
\end{Highlighting}
\end{Shaded}

\cleardoublepage
    \bookmarksetupnext{level=part}
    \phantomsection
    \addcontentsline{toc}{chapter}{References}
    \begin{centering}
    REFERENCES\\
    \vskip 1 \baselineskip
    \end{centering}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-rsg21}{}}%
{``ActivitySim: An Advanced Activity-Based Travel Demand Model Built by and for Users.''} 2021. \emph{RSG}. \url{https://rsginc.com/activitysim-white-paper/\#advanced-activity-based-travel-demand-model}.

\leavevmode\vadjust pre{\hypertarget{ref-agrc}{}}%
AGRC. 2021. \emph{Automated Geographic Reference Center}. \url{https://gis.utah.gov/}.

\leavevmode\vadjust pre{\hypertarget{ref-arentze00}{}}%
Arentze, Theo, and Harry Timmermans. 2000. \emph{Albatross: A Learning Based Transportation Oriented Simulation System}. Citeseer.

\leavevmode\vadjust pre{\hypertarget{ref-ax08}{}}%
Axhausen, K, M Balmer, and F Ciari. 2008. {``A New Mode Choice Model for a Multi-Agent Transport Simulation.''} In \emph{8th Swiss Transport Research Conference. ETH, Eidgen{ö}ssische Technische Hochschule}.

\leavevmode\vadjust pre{\hypertarget{ref-barth20}{}}%
Barth, Matthew, Peng Hao, Guoyuan Wu, Shams Tanvir, Chao Wang, Jeff Gonder, Jacob Holden, Andrew Devall, and Bingrong Sun. 2020. {``Evaluating Energy Efficiency Opportunities from Connected and Automated Vehicle Deployments Coupled with Shared Mobility in California.''} University of California-Riverside.

\leavevmode\vadjust pre{\hypertarget{ref-ben02}{}}%
Ben-Akiva, Moshe, Daniel Mcfadden, Kenneth Train, Joan Walker, Chandra Bhat, Michel Bierlaire, Denis Bolduc, et al. 2002. {``Hybrid Choice Models: Progress and Challenges.''} \emph{Marketing Letters} 13 (3): 163--75. \url{https://doi.org/10.1023/a:1020254301302}.

\leavevmode\vadjust pre{\hypertarget{ref-ben02num2}{}}%
Ben-Akiva, Moshe, Joan Walker, Adriana T. Bernardino, Dinesh A. Gopinath, Taka Morikawa, and Amalia Polydoropoulou. 2002. {``Integration of Choice and Latent Variable Models.''} \emph{In Perpetual Motion}, 431--70. \url{https://doi.org/10.1016/b978-008044044-6/50022-x}.

\leavevmode\vadjust pre{\hypertarget{ref-bhat95}{}}%
Bhat, Chandra R. 1995. {``A Heteroscedastic Extreme Value Model of Intercity Travel Mode Choice.''} \emph{Transportation Research Part B: Methodological} 29 (6): 471--83.

\leavevmode\vadjust pre{\hypertarget{ref-bhat99}{}}%
Bhat, Chandra R, and Frank S Koppelman. 1999. {``Activity-Based Modeling of Travel Demand.''} In \emph{Handbook of Transportation Science}, 35--61. Springer.

\leavevmode\vadjust pre{\hypertarget{ref-bowman01}{}}%
Bowman, J. L, and M. E Ben-Akiva. 2001. {``Activity-Based Disaggregate Travel Demand Model System with Activity Schedules.''} \emph{Transportation Research Part A: Policy and Practice} 35 (1): 1--28. \url{https://doi.org/10.1016/s0965-8564(99)00043-9}.

\leavevmode\vadjust pre{\hypertarget{ref-bowman06}{}}%
Bowman, John L., Mark A. Bradley, and John Gibbs. 2006. {``The Sacramento Activity-Based Travel Demand Model: Estimation and Validation Results.''} \emph{In European Transport Conference.}

\leavevmode\vadjust pre{\hypertarget{ref-bowman99}{}}%
Bowman, John L, Mark Bradley, Yoram Shiftan, T Keith Lawton, and Moshe Ben-Akiva. 1999. {``Demonstration of an Activity-Based Model for Portland.''} In \emph{World Transport Research: Selected Proceedings of the 8th World Conference on Transport ResearchWorld Conference on Transport Research Society}. Volume 3.

\leavevmode\vadjust pre{\hypertarget{ref-zarwi17}{}}%
El Zarwi, Feras, Akshay Vij, and Joan L Walker. 2017. {``A Discrete Choice Framework for Modeling and Forecasting the Adoption and Diffusion of New Transportation Services.''} \emph{Transportation Research Part C: Emerging Technologies} 79: 207--23.

\leavevmode\vadjust pre{\hypertarget{ref-eluru10}{}}%
Eluru, Naveen, Abdul Pinjari, Ram Pendyala, and Chandra Bhat. 2010. {``An Econometric Multi-Dimensional Choice Model of Activity-Travel Behavior.''} \emph{Transportation Letters} 2 (4): 217--30. \url{https://doi.org/10.3328/tl.2010.02.04.217-230}.

\leavevmode\vadjust pre{\hypertarget{ref-gali08}{}}%
Gali, Emmanuel, Stephan Eidenbenz, Sue Mniszewski, Leticia Cuellar, and Christof Teuscher. 2008. {``ActivitySim: Large-Scale Agent Based Activity Generation for Infrastructure Simulation,''} January. \url{https://www.osti.gov/biblio/960770}.

\leavevmode\vadjust pre{\hypertarget{ref-bhat20}{}}%
Goulias, Konstadinos G., Adam Wilkinson Davis, and Chandra R. Bhat. 2020. {``Chapter 5 - Consumer Choice Modeling: The Promises and the Cautions.''} In \emph{Mapping the Travel Behavior Genome}, 63--80. Elsevier.

\leavevmode\vadjust pre{\hypertarget{ref-hasnine21}{}}%
Hasnine, Md Sami, and Khandker Nurul Habib. 2021. {``Tour-Based Mode Choice Modelling as the Core of an Activity-Based Travel Demand Modelling Framework: A Review of State-of-the-Art.''} \emph{Transport Reviews} 41 (1): 5--26. \url{https://doi.org/10.1080/01441647.2020.1780648}.

\leavevmode\vadjust pre{\hypertarget{ref-horl18}{}}%
Hörl, Sebastian, Milos Balac, and Kay W Axhausen. 2018. {``A First Look at Bridging Discrete Choice Modeling and Agent-Based Microsimulation in MATSim.''} \emph{Procedia Computer Science} 130: 900--907.

\leavevmode\vadjust pre{\hypertarget{ref-horl19}{}}%
Hörl, Sebastian, Miloš Balać, and Kay W Axhausen. 2019. {``Pairing Discrete Mode Choice Models and Agent-Based Transport Simulation with MATSim.''} In \emph{2019 TRB Annual Meeting Online}, 19--02409. Transportation Research Board.

\leavevmode\vadjust pre{\hypertarget{ref-nate}{}}%
Lant, Nathan John. 2021. {``Estimation and Simulation of Daily Activity Patterns for Individuals Using Wheelchairs.''} PhD thesis, Brigham Young University.

\leavevmode\vadjust pre{\hypertarget{ref-manski2001}{}}%
Manski, Charles F. 2001. {``Daniel McFadden and the Econometric Analysis of Discrete Choice.''} \emph{The Scandinavian Journal of Economics} 103 (2): 217--29.

\leavevmode\vadjust pre{\hypertarget{ref-mcfadden1973}{}}%
McFadden, Daniel et al. 1973. {``Conditional Logit Analysis of Qualitative Choice Behavior.''}

\leavevmode\vadjust pre{\hypertarget{ref-mcfadden86}{}}%
McFadden, Daniel. 1986. {``The Choice Theory Approach to Market Research.''} \emph{Marketing Science} 5 (4): 275--97.

\leavevmode\vadjust pre{\hypertarget{ref-mcnally2000four}{}}%
McNally, Michael G. 2000. {``The Four Step Model.''} In \emph{Handbook of Transport Modelling}. Emerald Group Publishing Limited.

\leavevmode\vadjust pre{\hypertarget{ref-miller05}{}}%
Miller, Eric J., Matthew J. Roorda, and Juan Antonio Carrasco. 2005. {``A Tour-Based Model of Travel Mode Choice.''} \emph{Transportation} 32 (4): 399--422. \url{https://doi.org/10.1007/s11116-004-7962-3}.

\leavevmode\vadjust pre{\hypertarget{ref-mtc12}{}}%
MTC. 2012. \emph{Travel Model Development: Calibration and Validation Technical Report}. Metropolitan Transportation Commission with Parsons Brinckerhoff, Inc.

\leavevmode\vadjust pre{\hypertarget{ref-habib17}{}}%
Nurul Habib, Khandker. 2017. {``A Comprehensive Utility-Based System of Activity-Travel Scheduling Options Modelling (Custom) for Worker's Daily Activity Scheduling Processes.''} \emph{Transportmetrica A: Transport Science} 14 (4): 292--315. \url{https://doi.org/10.1080/23249935.2017.1385656}.

\leavevmode\vadjust pre{\hypertarget{ref-ortuzar94}{}}%
Ortuzar, J.de D., and L. G.Willumsen. 1994. Wiley.

\leavevmode\vadjust pre{\hypertarget{ref-paulssen14}{}}%
Paulssen, Marcel, Dirk Temme, Akshay Vij, and Joan L. Walker. 2014. {``Values, Attitudes and Travel Behavior: A Hierarchical Latent Variable Mixed Logit Model of Travel Mode Choice.''} \emph{Transportation} 41 (4): 873--88. \url{https://doi.org/10.1007/s11116-013-9504-3}.

\leavevmode\vadjust pre{\hypertarget{ref-pendyala05}{}}%
Pendyala, Ram M., Ryuichi Kitamura, Akira Kikuchi, Toshiyuki Yamamoto, and Satoshi Fujii. 2005. {``Florida Activity Mobility Simulator.''} \emph{Transportation Research Record: Journal of the Transportation Research Board} 1921 (1): 123--30. \url{https://doi.org/10.1177/0361198105192100114}.

\leavevmode\vadjust pre{\hypertarget{ref-pendyala97}{}}%
Pendyala, Ram M, Ryuichi Kitamura, Cynthia Chen, and Eric I Pas. 1997. {``An Activity-Based Microsimulation Analysis of Transportation Control Measures.''} \emph{Transport Policy} 4 (3): 183--92.

\leavevmode\vadjust pre{\hypertarget{ref-pinjari07}{}}%
Pinjari, Abdul Rawoof, Ram M. Pendyala, Chandra R. Bhat, and Paul A. Waddell. 2007. {``Modeling Residential Sorting Effects to Understand the Impact of the Built Environment on Commute Mode Choice.''} \emph{Transportation} 34 (5): 557--73. \url{https://doi.org/10.1007/s11116-007-9127-7}.

\leavevmode\vadjust pre{\hypertarget{ref-popsim}{}}%
PopulationSim. 2021. \emph{An Open Platform for Population Synthesis} (version Version: 0.5). \url{https://activitysim.github.io/populationsim/}.

\leavevmode\vadjust pre{\hypertarget{ref-saleem18}{}}%
Saleem, Mohammad, Oskar Blom Västberg, and Anders Karlström. 2018. {``An Activity Based Demand Model for Large Scale Simulations.''} \emph{Procedia Computer Science} 130: 920--25.

\leavevmode\vadjust pre{\hypertarget{ref-vij13}{}}%
Vij, Akshay, André Carrel, and Joan L. Walker. 2013. {``Incorporating the Influence of Latent Modal Preferences on Travel Mode Choice Behavior.''} \emph{Transportation Research Part A: Policy and Practice} 54: 164--78. \url{https://doi.org/10.1016/j.tra.2013.07.008}.

\leavevmode\vadjust pre{\hypertarget{ref-vovsha17}{}}%
Vovsha, P., J. E. Hicks, G. Vyas, V. Livshits, K. Jeon, R. Anderson, and G. Giaimo. 2017. {``Combinatorial Tour Mode Choice.''} In \emph{Presented at He 96th Annual Meeting of Transportation Research Board}.

\leavevmode\vadjust pre{\hypertarget{ref-horni16}{}}%
W Axhausen, Kay, Andreas Horni, and Kai Nagel. 2016. \emph{The Multi-Agent Transport Simulation MATSim}. Ubiquity Press.

\leavevmode\vadjust pre{\hypertarget{ref-xie2015}{}}%
Xie, Yihui. 2015. \emph{Dynamic Documents with {R} and Knitr}. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. \url{http://yihui.org/knitr/}.

\leavevmode\vadjust pre{\hypertarget{ref-R-bookdown}{}}%
---------. 2021. \emph{Bookdown: Authoring Books and Technical Documents with r Markdown}. \url{https://CRAN.R-project.org/package=bookdown}.

\end{CSLReferences}


% Index?

\end{document}
